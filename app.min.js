/*! webhook - v - 2014-05-28
* https://github.com//webhook
* Copyright (c) 2014 ; Licensed MIT */
!function(){"use strict";["uploadUrl","uploadSite","uploadToken"].forEach(function(a){localStorage.getItem(a)&&$("#"+a).val(localStorage.getItem(a)),$("#"+a).on("change",function(){localStorage.setItem(a,$(this).val())})});var a=$("#select-file button.single").selectFile(),b=$("#select-file button.multiple").selectFile({multiple:!0}),c=$("#select-file button.images").selectFile({multiple:!0,accept:"image/*"});a.add(b).add(c).on("selectedFile",function(a,b){var c=$("<li>").appendTo("#select-file .filenames").text(b.name);setTimeout(function(){c.fadeOut(500,function(){$(this).remove()})},5e3)}),$(".wy-alert[data-dropzone]").on("drop",function(a){for(var b=a.originalEvent.dataTransfer.files,c=0;c<b.length;c++)$("<p>").appendTo(this).text(b[c].name)});var d=new Webhook.Uploader($("#uploadUrl").val(),$("#uploadSite").val(),$("#uploadToken").val(),{data:{foo:"bar"}}),e=$("#upload button.icon-image");e.selectFile().on("selectedFile",function(a,b){$(".wy-form-upload-container").show(),$(".wy-form-upload-url").hide(),$(this).hide(),$(".wy-form-upload .image-loading").css("display","inline-block");var c=d.upload(b);c.progress(function(a){var b=Math.ceil(100*a.loaded/a.total);100>b?$(".wy-form-upload .image-loading span").html("Uploading <span>"+b+"%</span>"):$(".wy-form-upload .image-loading span").text("Finishing up...")}),c.done(function(a){$("#upload .output").val(a.url)}),c.always(function(){$(".wy-form-upload .image-loading").hide(),e.show()})}),$(".wy-form-upload-url .upload-url").on("click",function(){e.trigger("selectedFile",$(".wy-form-upload-url input").val()),$(".wy-form-upload-url input").val("")}),$(".upload-method-toggle").on("click",function(){$(".wy-form-upload-container, .wy-form-upload-url").toggle()});var f=function(){$(this).removeClass("icon-desktop icon-arrow-down btn-success").addClass("icon-image btn-neutral").text(" Drag or select image")};e.dropzone().on({dropzonewindowenter:function(){$(this).removeClass("icon-image icon-desktop btn-neutral").addClass("icon-arrow-down btn-success").text(" Drop files here")},dropzonewindowdrop:f,dropzonewindowleave:f,drop:function(a){$(this).trigger("selectedFile",a.originalEvent.dataTransfer.files[0]),f.call(this)}}),e.on({mouseenter:function(){$(this).removeClass("icon-image icon-arrow-down btn-success").addClass("icon-desktop btn-neutral").text(" Select from desktop")},mouseleave:f})}();